<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="author" content="Aravind V. Nair" />
		<link
			href="https://fonts.googleapis.com/css?family=Poppins:300,400"
			rel="stylesheet"
		/>
		<link href="css/main.css" rel="stylesheet" />
	</head>
	<body>
		<div class="s128">
			<form>
				<div class="inner-form">
					<div
						class="row"
						style="text-align: center; font-size: x-large;"
					>
						<h1>Start searching!</h1>
						<br />
						<div class="input-field first" id="first">
							<input
								class="input"
								id="inputFocus"
								type="text"
								placeholder="Keyword"
								onkeypress="return (getRating(event,this))"
							/>
							<button class="clear" id="clear">
								<svg
									xmlns="http://www.w3.org/2000/svg"
									width="24"
									height="24"
									viewBox="0 0 24 24"
								>
									<path
										d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
									></path>
								</svg>
							</button>
						</div>
						<p id="pythonOutput"></p>
					</div>
				</div>
			</form>
		</div>
		<script>
			var btnDelete = document.getElementById("clear");
			var inputFocus = document.getElementById("inputFocus");
			btnDelete.addEventListener("click", (e) => {
				e.preventDefault();
				inputFocus.value = "";
			});
			document.addEventListener("click", (e) => {
				if (document.getElementById("first").contains(e.target)) {
					inputFocus.classList.add("isFocus");
				} else {
					// Clicked outside the box
					inputFocus.classList.remove("isFocus");
				}
			});
			function getRating(event, str) {
				if (event.charCode === 13) {
					document.getElementById(
						"pythonOutput"
					).innerHTML = `Please wait! Querying for ${str.value}...`;
					fetch("/getRating", {
						method: "POST",
						body: new URLSearchParams(
							encodeURIComponent("input") +
								"=" +
								encodeURIComponent(str.value)
						),
					})
						.then((response) => {
							if (response.status !== 200) {
								alert(
									"Looks like there was a problem. Status Code: " +
										response.status
								);
								return;
							}
							if (response.status == 200) {
								response.json().then((data) => {
									document.getElementById(
										"pythonOutput"
									).innerHTML = data;
								});
							}
						})
						.catch((err) => {
							alert("Fetch Error :-S", err);
							document.getElementById(
								"pythonOutput"
							).innerHTML = `Fetch Error: ${err}`;
						});
				}
			}
		</script>
	</body>
</html>
